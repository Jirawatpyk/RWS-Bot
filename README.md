Auto-RWS
ภาพรวม

Auto-RWS เป็นระบบอัตโนมัติที่ออกแบบมาเพื่อจัดการและรับงาน (tasks) จากอีเมลที่เข้ามาผ่านโปรโตคอล IMAP โดยระบบจะทำการล็อกอินเข้าสู่แพลตฟอร์มเป้าหมายผ่าน Puppeteer จากนั้นจะทำการ "accept" งานตามลิงก์ที่ได้รับจากอีเมล และบันทึกผลลัพธ์ลงใน Google Sheets นอกจากนี้ยังมี Dashboard สำหรับติดตามสถานะของงานแบบเรียลไทม์อีกด้วย

คุณสมบัติหลัก
การประมวลผลอีเมลอัตโนมัติ: เชื่อมต่อกับเซิร์ฟเวอร์ IMAP เพื่อดึงอีเมลใหม่และประมวลผลลิงก์ของงานที่ได้รับ
การทำงานอัตโนมัติบนเบราว์เซอร์: ใช้ Puppeteer เพื่อทำการล็อกอินและคลิก "accept" งานบนเว็บไซต์โดยอัตโนมัติ
การจัดการคิวงาน: มีระบบคิว (Task Queue) เพื่อจัดการการทำงานหลายๆ อย่างพร้อมกันได้อย่างมีประสิทธิภาพ
การติดตามและรายงานผล: บันทึกสถานะของแต่ละงาน (สำเร็จ/ล้มเหลว) ลงใน Google Sheets และมีระบบรายงานผ่าน Google Chat
แดชบอร์ด: แสดงสถานะของงานแบบเรียลไทม์ผ่านเว็บอินเตอร์เฟส
การจัดการความจุ (Capacity Management): มีระบบติดตามและจัดการปริมาณงานในแต่ละวันเพื่อไม่ให้เกินขีดจำกัดที่ตั้งไว้
การแจ้งเตือน: แจ้งเตือนผ่าน Google Chat เมื่อมีข้อผิดพลาดหรือเมื่อปริมาณงานถึงเกณฑ์ที่กำหนด
การจัดการเซสชัน: บันทึกและนำคุกกี้กลับมาใช้ใหม่เพื่อลดความจำเป็นในการล็อกอินทุกครั้ง
โครงสร้างไฟล์

/Auto-RWS/
├── Config/             # ไฟล์การตั้งค่าต่างๆ ของโปรเจกต์
├── Dashboard/          # ไฟล์สำหรับ Web Dashboard
├── Exec/               # สคริปต์สำหรับการทำงานบนเบราว์เซอร์ (Puppeteer)
├── Google/             # การเชื่อมต่อกับ Google Sheets API
├── IMAP/               # โมดูลสำหรับการเชื่อมต่อและประมวลผลอีเมล
├── Logs/               # ไฟล์บันทึกการทำงานของระบบ (Log files)
├── LoginSession/       # สคริปต์สำหรับจัดการการล็อกอิน
├── public/             # ไฟล์สำหรับหน้าเว็บของ Dashboard
├── Session/            # ไฟล์สำหรับจัดเก็บข้อมูลเซสชัน (เช่น คุกกี้)
├── Sheets/             # โมดูลสำหรับอ่านและเขียนข้อมูลบน Google Sheets
├── Task/               # โมดูลสำหรับจัดการคิวงาน, ตรวจสอบความจุ และรายงานผล
├── utils/              # ฟังก์ชันเสริมต่างๆ ที่ใช้ในโปรเจกต์
├── main.js             # ไฟล์หลักในการรันโปรแกรม
├── package.json        # รายการ Dependencies และสคริปต์ต่างๆ
└── ecosystem.config.js # ไฟล์การตั้งค่าสำหรับ PM2

การติดตั้งและใช้งาน
ติดตั้ง Dependencies:
npm install
ตั้งค่า Environment Variables:
สร้างไฟล์ .env และกำหนดค่าต่างๆ ที่จำเป็น เช่น ข้อมูลการล็อกอิน, Google Sheets API keys และอื่นๆ ตามที่ระบุในไฟล์ Config/configs.js.
รันโปรแกรม:
ใช้ PM2 ในการรันโปรแกรมเพื่อให้ทำงานได้อย่างต่อเนื่อง:
pm2 start ecosystem.config.js
หรือรันโดยตรงผ่าน Node.js:
node main.js
การตั้งค่า (Configuration)
Config/configs.js: ไฟล์หลักที่ใช้ในการตั้งค่าต่างๆ เช่น Google Sheet IDs, ตำแหน่งคอลัมน์ และการตั้งค่าอื่นๆ ของโปรเจกต์
.env: ไฟล์สำหรับเก็บข้อมูลสำคัญที่ไม่ควรเปิดเผย เช่น ข้อมูลการล็อกอิน, Webhook URL และอื่นๆ
สคริปต์สำคัญ
main.js: เป็นไฟล์เริ่มต้นของโปรแกรม ทำหน้าที่ในการล็อกอิน, เริ่มระบบ IMAP, จัดการคิวงาน และเชื่อมต่อกับโมดูลอื่นๆ
IMAP/imapClient.js: จัดการการเชื่อมต่อกับเซิร์ฟเวอร์ IMAP และดึงอีเมลใหม่
Exec/execAccept.js: สคริปต์ Puppeteer ที่ใช้ในการเปิดเบราว์เซอร์และคลิก "accept" งาน
Task/CapacityTracker.js: ระบบจัดการและติดตามปริมาณงานในแต่ละวัน
Dashboard/server.js: เซิร์ฟเวอร์สำหรับ Dashboard ที่ใช้ Express และ WebSocket ในการแสดงผลแบบเรียลไทม์
Sheets/sheetWriter.js / sheetReader.js: โมดูลสำหรับอ่านและเขียนข้อมูลลงบน Google Sheets
Dependencies
`puppeteer`: สำหรับการทำงานอัตโนมัติบนเบราว์เซอร์
`imapflow`: สำหรับการเชื่อมต่อกับ IMAP server
`googleapis`, `google-spreadsheet`: สำหรับการใช้งาน Google Sheets API
`express`, `ws`: สำหรับการสร้าง Web Dashboard
`dayjs`: สำหรับการจัดการวันที่และเวลา
`dotenv`: สำหรับการจัดการ Environment Variables
`pm2`: สำหรับการจัดการโปรเซสของ Node.js (แนะนำให้ติดตั้งแบบ global)